<script>
    // 1. Prepare data
    const name = localStorage.getItem('uName') || "Customer";
    const service = localStorage.getItem('uService') || "Service";
    const msg = `Hi TechUrban HQ, I am ${name}. I just submitted an order for ${service}. Let's discuss pricing!`;
    const waUrl = `https://wa.me/2348032677977?text=${encodeURIComponent(msg)}`;
    
    const waBtn = document.getElementById('waBtn');
    waBtn.href = waUrl;

    // 2. The Interaction Logic
    waBtn.addEventListener('click', function(e) {
        // We let the default "target=_blank" open WhatsApp in a new tab
        
        // Then we immediately "reset" this current tab to the Home Page
        // This happens so fast it feels like a fresh visit when they return
        setTimeout(() => {
            window.location.replace("index.html");
        }, 500); 
    });

    // 3. Fallback: Auto-trigger (might still be blocked, but the button is the main way)
    window.onload = function() {
        // We still try to auto-open for some browsers, but we change the text
        // to encourage the click which is "Popup Blocker" safe.
        setTimeout(() => {
            console.log("Ready for user to proceed to WhatsApp.");
        }, 2000);
    };
</script>
